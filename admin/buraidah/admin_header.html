<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="{lang.LANG_SMALL_NAME}" xml:lang="{lang.LANG_SMALL_NAME}">
<head>
<title>{lang.KLEEJA_CP} - {config.sitename}</title>
<!-- top-head -->
<meta http-equiv="Content-Language" content="{lang.LANG_SMALL_NAME}" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" />
<link rel="shortcut icon" href="{STYLE_PATH_ADMIN}images/favicon.ico" />
<link rel="icon" type="image/gif" href="{STYLE_PATH_ADMIN}images/favicon.gif" />

<link rel="stylesheet" type="text/css" media="screen" href="{STYLE_PATH_ADMIN}css/global.css" />
<link rel="stylesheet" type="text/css" media="screen" href="{STYLE_PATH_ADMIN}css/byname.css" />
<link rel="stylesheet" type="text/css" media="screen" href="{STYLE_PATH_ADMIN}js/fancybox/jqueryfb.css" />
<IF NAME="{lang.DIR}==rtl"><link rel="stylesheet" type="text/css" media="screen" href="{STYLE_PATH_ADMIN}css/rtl.css" /></IF>	
<IS_BROWSER="ie6"><link rel="stylesheet" type="text/css" media="screen" href="{STYLE_PATH_ADMIN}css/ie6.css" /></IS_BROWSER>
<IS_BROWSER="ie"><link rel="stylesheet" type="text/css" media="screen" href="{STYLE_PATH_ADMIN}css/ie.css" /></IS_BROWSER>

<script type="text/javascript">
<!--//
var STYLE_PATH_ADMIN = '{STYLE_PATH_ADMIN}';var go_to = '{go_to}';
//-->
</script>
<script type="text/javascript" src="{STYLE_PATH_ADMIN}js/jquery.min.js"></script>
<script type="text/javascript" src="{STYLE_PATH_ADMIN}js/fancybox/fancybox.js"></script>
<script type="text/javascript">
<!--//
jQuery(document).ready(function($){
	//for more menu at top menu
	$('.top-bar .home').hover(
			function () { $('ul', this).slideDown(50); }, 
			function () { $('ul', this).slideUp(50); }
	).click(function() {
			$('#content').html('<h1>{lang.MENU}</h1><ul class="menu_but_in_content">' + $('.top-bar .home ul').html() + '</ul>');
	});
	

	//for # in address bar
	hash = window.location.hash.replace('#!', '');
	if(hash != '')
	{
		get_kleeja_link('./?' + hash);
	}
});

function get_kleeja_link(URL, ID, p)
{
	if(!p)
	{
		p = {};
	}

	if(!ID)
	{
		ID = '#content';
	}

	$("#sign_ajax_error").css('display', 'none');

	if(p['confirm'])
	{
		if(!confirm_from())
		{
			return;
		}
	}

	//$(ID).css('display', 'none');
	$(ID).addClass('show_less');
	
	if(URL.indexOf('?') == -1)
	{
		URL += '?';
	}
	
	window.location.hash = '!' + URL.replace('&amp;', '&').split('?', 2)[1];
	if(window.location.hash.indexOf('formkey') != -1)
	{
		window.location.hash = window.location.hash.replace(/&formkey=[a-z0-9]+/, '');
	}

	$("#sign_ajax").show();

	$.ajax({
		url: URL.replace('&amp;', '&') + '&_ajax_=1',
		cache: false,
		dataType: 'json',
		success: function(R){
			
			$("#sign_ajax").css('display', 'none');

			//not login 
			if(R.code == 999)
			{
				location.href = './';
			}
			else if(R.code == 888)
			{
				//alert(R.content);
				get_kleeja_link(URL, ID);
				return;
			}
			else
			{
				$(ID).html(R.content);
				
				if(p['current_id'])
				{
					$('.' + p['current_class']).removeClass(p['current_class']);
					$('#' + p['current_id']).addClass(p['current_class']);
				}
				
				$(ID).removeClass('show_less');
				$(ID).fadeIn(100);

				if($('body').scrollTop() > 0 && $('body').scrollTop() > 200)
				{
					$('body').animate({scrollTop:0}, 'slow');
				}
				else if($('html').scrollTop() > 0 && $('html').scrollTop() > 230)
				{
					$('html').animate({scrollTop:0}, 'slow');
				}
				
				$('#menu .current-items ul').html(R.menu);
			}
		},
		error : function(R){
			//$(ID).html('----');
			$("#sign_ajax").css('display', 'none');
			$("#sign_ajax_error").show();
		}
	});
}

function submit_kleeja_data(FORM_ID, ID, CONFIRM)
{
	if(!ID)
	{
		ID = '#content';
	}

	if(CONFIRM)
	{
		if(!confirm_from())
		{
			return;
		}
	}
	
	$("#sign_ajax_error").css('display', 'none');
	//$(ID).css('display', 'none');
	$(ID).addClass('show_less');
	$("#sign_ajax").show();
	
	$.ajax({
		type: 'POST',
		url: $(FORM_ID).attr('action').replace('&amp;', '&') + '&_ajax_=1',
		data: $(FORM_ID).serialize(),
		cache: false,
		dataType: 'json',
		success: function(R){
			
			$("#sign_ajax").css('display', 'none');
			
			//not login 
			if(R.code == 999)
			{
				location.href = './';
			}
			else if(R.code == 888)
			{
				//alert(R.content);
				get_kleeja_link($(FORM_ID).attr('action'), ID);
				return;
			}
			else
			{
				$(ID).html(R.content);
				$(ID).removeClass('show_less');
				$(ID).fadeIn(100);
				if($('body').scrollTop() > 0 && $('body').scrollTop() > 200)
				{
					$('body').animate({scrollTop:0}, 'slow');
				}
				else if($('html').scrollTop() > 0 && $('html').scrollTop() > 230)
				{
					$('html').animate({scrollTop:0}, 'slow');
				}
				
				$('#menu .current-items ul').html(R.menu);
			}
		},
		error : function(R){
			//$(ID).html('----');
			$("#sign_ajax").css('display', 'none');
			$("#sign_ajax_error").show();
		}
	});
}

function change_color(obj, id, c, c2) {
    c = (c == null) ? 'ored' : c;
    c2 = (c == null) ? 'osilver' : c2;
    var ii = document.getElementById(id);
    if (obj.checked) {
        ii.setAttribute("class", c);
        ii.setAttribute("className", c)
    } else {
        ii.setAttribute("class", c2);
        ii.setAttribute("className", c2)
    }
}
function checkAll(form, id, _do_c_, c, c2) {
    for (var i = 0; i < form.elements.length; i++) {
        if (form.elements[i].getAttribute("rel") != id) continue;
        if (form.elements[i].checked) {
            uncheckAll(form, id, _do_c_, c, c2);
            break
        }
        form.elements[i].checked = true;
        change_color(form.elements[i], _do_c_ + '[' + form.elements[i].value + ']', c, c2)
    }
}
function uncheckAll(form, id, _do_c_, c, c2) {
    for (var i = 0; i < form.elements.length; i++) {
        if (form.elements[i].getAttribute("rel") != id) continue;
        form.elements[i].checked = false;
        change_color(form.elements[i], _do_c_ + '[' + form.elements[i].value + ']', c, c2)
    }
}
function change_color_exts(id) {
    eval('var ii = document.getElementById("su[' + id + ']");');
    eval('var g_obj = document.getElementById("gal_' + id + '");');
    eval('var u_obj = document.getElementById("ual_' + id + '");');
    if (g_obj.checked && u_obj.checked) {
        ii.setAttribute("class", 'o_all');
        ii.setAttribute("className", 'o_all')
    } else if (g_obj.checked) {
        ii.setAttribute("class", 'o_g');
        ii.setAttribute("className", 'o_g')
    } else if (u_obj.checked) {
        ii.setAttribute("class", 'o_u');
        ii.setAttribute("className", 'o_u')
    } else {
        ii.setAttribute("class", '');
        ii.setAttribute("className", '')
    }
}
function checkAll_exts(form, id, _do_c_) {
    for (var i = 0; i < form.elements.length; i++) {
        if (form.elements[i].getAttribute("rel") != id) continue;
        if (form.elements[i].checked) {
            uncheckAll_exts(form, id, _do_c_);
            break
        }
        form.elements[i].checked = true;
        change_color_exts(form.elements[i].value)
    }
}
function uncheckAll_exts(form, id, _do_c_) {
    for (var i = 0; i < form.elements.length; i++) {
        if (form.elements[i].getAttribute("rel") != id) continue;
        form.elements[i].checked = false;
        change_color_exts(form.elements[i].value)
    }
}
//-->
</script>
</head>
<body>

<!-- ajax loading sign -->
<div id="sign_ajax"><img src="{STYLE_PATH_ADMIN}images/ajax-loader-small.gif" /> {lang.LOADING} ...</div>
<div id="sign_ajax_error"><img src="{STYLE_PATH_ADMIN}images/error.png" /> {lang.ERROR_AJAX}</div>
	


<div id="wrap">
	<!-- secondary menu -->
	<div id="menu">
		<div class="top-bar">
			<div class="home">
				<img src="{STYLE_PATH_ADMIN}images/logo.gif" alt="{lang.MENU}" title="{lang.MENU}"  />
				<ul>
					<LOOP NAME="adm_extensions_menu">
						<li class="({{current}}?active:)" id="g_{{goto}}">
							<a href="{{link}}" onclick="javascript:get_kleeja_link('{{link}}', '#content', {'current_id':'g_{{goto}}', 'current_class':'link_current'<IF LOOP="confirm">, 'confirm':true</IF>}); return false;">
								{{lang}}{{kbubble}}
							</a>
						</li>
					</LOOP>
					</ul>
			</div>
			<div class="cats">
				<a href="./" onclick="javascript:get_kleeja_link('./'); return false;" title="{lang.R_CPINDEX}">
					<img src="{STYLE_PATH_ADMIN}images/home.png" alt="{lang.R_CPINDEX}"/>
				</a>
				<a href="{config.siteurl}" title="{lang.RETURN_HOME}">
					<img src="{STYLE_PATH_ADMIN}images/website.png" alt="{lang.RETURN_HOME}" />
				</a>
				<a href="./?cp=b_lgoutcp&amp;{GET_FORM_KEY_GLOBAL}" onclick="javascript:return confirm_from();" title="{lang.R_LGOUTCP}" >
					<img src="{STYLE_PATH_ADMIN}images/logout.png" alt="{lang.RETURN_HOME}" alt="{lang.R_LGOUTCP}"/>
				</a>
				<a href="./?cp=options" onclick="javascript:get_kleeja_link('./?cp=options', '#content', {}); return false;" title="{lang.R_CONFIGS}">
					<img src="{STYLE_PATH_ADMIN}images/settings.png"  alt="{lang.R_CONFIGS}" />
				</a>
				<div class="clear"></div>
			</div>
		</div>
		
		<div class="current-title">
			{lang.WELCOME}
		</div>
		
		<div class="current-items">
			<ul id="navlist">
			<IF NAME="go_menu">
				<LOOP NAME="go_menu">
					<li class="({{current}}?active:)" id="c_{{goto}}"><a href="{{link}}" onclick="javascript:get_kleeja_link('{{link}}', '#content', {'current_id':'c_{{goto}}', 'current_class':'active'<IF LOOP="confirm">, 'confirm':true</IF>}); return false;">{{name}}</a></li>
				</LOOP>
			</IF>
			</ul>
		</div>
		
		<div class="bottom-logo"></div>
		
	</div>

	<div id="content">